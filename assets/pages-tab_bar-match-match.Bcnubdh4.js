import{_ as a,j as l,g as e,k as s,n as t,p as o,q as n,t as c,v as u,h as i,u as p,F as r,Y as d,aa as f,l as g,x as m,y as _,z as v,A as h,B as y,C,D as T,E as b,o as k,d as $,w as K,ab as w,m as A,J as D,K as j,I as x,i as B,e as F,R as P,S as H,T as I,ac as M,P as N,Q as S,U as O,V as R,W as q,Z as z,$ as E,a0 as J,ad as L,a6 as Q,a7 as U,a1 as V,a2 as W}from"./index-SUU5mfSv.js";import{p as Y,i as Z}from"./pwa.DEqUVdea.js";import{o as G,a as X,b as aa,c as la}from"./uni-app.es.BFzw-cPf.js";const ea=18e5,sa=a({__name:"match",setup(a){const sa=l(0),ta=l(w(1e3,1100));let oa=null;const na=()=>{null==oa||oa.pause(),oa=null,oa=d({targets:ta,value:w(1e3,1100),easing:"linear",round:1,duration:1e3,delay:3e3,complete:()=>{na()}})},ca=e(),ua=l(ca.matchCardDiamonds??0),ia=l(null),pa=l(s("devicePermission")),ra=()=>{A({success:()=>{pa.value=!0},fail:()=>{pa.value=!1,D()}})},da=l(t.recharge.tr);let fa=Date.now(),ga=o()?n():c();o()&&u({type:2,success:a=>{if(console.log("首充"),!j)for(const e of a)e.ppp=e.ppp.filter((a=>1!=a.ppType&&2!=a.ppType));const l=a.filter((a=>a.ppp.length>0)).filter((a=>2==a.productType&&1==a.discountType));l.length>0?ia.value=l[0]:ia.value=null}});const{appLogin:ma,userBalance:_a,userHaveMatchCard:va}=i(p());let ha=null;r((()=>{ha=d({targets:".call-content",scale:[.9,1],loop:!0,autoplay:!0,duration:250,delay:500,easing:"easeInOutCirc",direction:"alternate",loopComplete:a=>{console.log("匹配按钮动画一次循环结束")}})})),f((()=>{null!=ha&&(ha.pause(),ha=null)}));let ya=!0;G((()=>{console.log("搜索出现 重启动画"),na(),pa.value=s("devicePermission"),ya=!0,fa=Date.now(),0==pa.value&&g()&&(x(),ra())})),X((()=>{console.log("搜索消失 关闭动画"),ya=!1,null==oa||oa.pause(),oa=null}));const Ca=l(!1);Ca.value=Y();const Ta=p().$onAction((({name:a,args:l})=>{"pwaStatusChanged"==a?Ca.value=Y():"globalTimerNTF"==a?ya&&(console.log("首充 倒计时计算"),fa+=1e3,ga>=fa-ea?da.value=m(ga,fa-ea):(console.log("首充 重启一个30分钟倒计时"),o()?(_(v(),!0),ga=n()):(h(!0),ga=c()))):"loginStatusHadChangedNotification"==a?o()?(console.log("首充 已登录 计时起始时间切换"),ga=n(),u({type:2,success:a=>{if(console.log("首充"),!j)for(const e of a)e.ppp=e.ppp.filter((a=>1!=a.ppType&&2!=a.ppType));const l=a.filter((a=>a.ppp.length>0)).filter((a=>2==a.productType&&1==a.discountType));l.length>0?ia.value=l[0]:ia.value=null}})):(console.log("首充 未登录 计时起始时间切换"),ga=c(),ia.value=null):"orderCompleteNotification"==a&&u({type:2,success:a=>{if(console.log("首充"),!j)for(const e of a)e.ppp=e.ppp.filter((a=>1!=a.ppType&&2!=a.ppType));const l=a.filter((a=>a.ppp.length>0)).filter((a=>2==a.productType&&1==a.discountType));l.length>0?ia.value=l[0]:ia.value=null}})}));const ba=()=>{L(),o()?Q({url:"/pages/tab_bar/match/matching"}):J()};return aa((()=>{console.log("匹配初始化 Adjust归因 上传一次"),y(),C(),T({}),b(),p().loadAllConversations({success:()=>{console.log("App初始化开始设置会话角标"),p().updateConversationBadge()}})})),la((()=>{Ta(),null==oa||oa.pause(),oa=null})),(a,l)=>{const e=B,s=U,t=V,n=W;return k(),$(e,{class:"bg"},{default:K((()=>[F(e,{class:"infinite-scro-bg"},{default:K((()=>[F(t,{"easing-function":a.linear,interval:sa.value,duration:15e4,onChange:l[0]||(l[0]=a=>sa.value=15e4),vertical:"",circular:"","disable-touch":"",autoplay:""},{default:K((()=>[F(s,null,{default:K((()=>[F(e,{class:"item-img item-img-1"})])),_:1}),F(s,null,{default:K((()=>[F(e,{class:"item-img item-img-2"})])),_:1})])),_:1},8,["easing-function","interval"])])),_:1}),F(e,{class:"infinite-scro-bg-cover"}),F(e,{class:"gradient-mask-top"}),F(e,{class:"gradient-mask-bottom"}),F(e,{class:"free-tip-bottom"},{default:K((()=>[F(e,{class:"match-tip"},{default:K((()=>[F(e,{class:"tip"},{default:K((()=>[F(n,null,{default:K((()=>[P(H(a.$lanKey.currentMatchTip.trArg(ta.value)),1)])),_:1})])),_:1}),F(e,{class:"call-content",onClick:ba},{default:K((()=>[F(e,{class:"icon"}),F(n,{class:"tip-call"},{default:K((()=>[P(H(a.$lanKey.randomMatch.tr),1)])),_:1}),null==I(M)||null==I(M)||""==I(M)||I(va)?(k(),$(e,{key:0,class:"tip"},{default:K((()=>[F(e,{class:"props props-match"}),F(n,null,{default:K((()=>[P(H(a.$lanKey.free.tr),1)])),_:1})])),_:1})):(k(),$(e,{key:1,class:"tip tip-price"},{default:K((()=>[F(e,{class:"diamond-image"}),F(n,null,{default:K((()=>[P(H(ua.value.toBin),1)])),_:1}),F(n,{class:"unit"},{default:K((()=>[P(H(a.$lanKey.unit.tr),1)])),_:1})])),_:1}))])),_:1})])),_:1}),N(F(e,{class:"permission-tip",onClick:l[1]||(l[1]=a=>ra())},{default:K((()=>[F(n,{class:"tip"},{default:K((()=>[P(H(a.$lanKey.mediaDiveceDisable.tr),1)])),_:1}),F(e,{class:"add"},{default:K((()=>[P(H(a.$lanKey.toOpen.tr),1)])),_:1})])),_:1},512),[[S,!0!==pa.value]])])),_:1}),F(e,{class:"b-safe-top home-safe-area-top"},{default:K((()=>[F(e,{class:"b-status-bar"}),F(e,{class:"home-nav"},{default:K((()=>[F(e,{class:"home_logo"},{default:K((()=>[F(e,{class:"home_logo_logo"}),F(e,{class:"home_logo_logo_text"})])),_:1}),I(ma)?(k(),$(e,{key:0,class:"diamond-choose",onClick:l[2]||(l[2]=a=>I(O)({path:I(R).matchHomeRemain}))},{default:K((()=>[F(e,{class:"diamond-image"}),F(n,{class:"diamond-text"},{default:K((()=>[P(H(I(_a)),1)])),_:1}),F(e,{class:"diamond-add"})])),_:1})):q("",!0)])),_:1})])),_:1}),N(F(e,{onClick:I(Z),class:"pwa-tip"},{default:K((()=>[F(n,{class:"tip"},{default:K((()=>[P(H(a.$lanKey.pwa_tip.tr),1)])),_:1}),F(e,{class:"area"},{default:K((()=>[F(e,{class:"add"},{default:K((()=>[P(H(a.$lanKey.add.tr),1)])),_:1}),F(e,{class:"cancel",onClick:l[3]||(l[3]=a=>{return l=a,Ca.value=!1,void l.stopPropagation();var l})})])),_:1})])),_:1},8,["onClick"]),[[S,Ca.value]]),F(e,{class:"recharge-first-float",onClick:l[4]||(l[4]=a=>(z(),void(o()?null!=ia.value?E({path:R.matchFloat}):O({path:R.matchFloat}):J())))},{default:K((()=>[F(e,{class:"recharge-first-float-time"},{default:K((()=>[I(ma)&&null==ia.value?(k(),$(n,{key:1},{default:K((()=>[P(H(a.$lanKey.recharge.tr),1)])),_:1})):(k(),$(n,{key:0},{default:K((()=>[P(H(da.value),1)])),_:1}))])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-41fdec7d"]]);export{sa as default};
