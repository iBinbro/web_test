import{_ as e,g as a,h as l,u as s,j as t,k as o,l as n,m as r,n as c,p as i,q as u,t as d,v as p,x as f,y as g,z as m,A as h,B as y,C as v,D as _,E as x,F as $,G as k,H as b,o as T,d as C,w as K,I as w,J as I,K as O,i as N,e as D,L as M,N as P,O as z,P as L,Q as j,R as F,S,T as A,U as B,V as q,W as E,X as V,Y as H,Z as R,$ as U,a0 as Y,a1 as Q,a2 as G,a3 as J,a4 as W,a5 as X,a6 as Z,f as ee,a7 as ae}from"./index-SUU5mfSv.js";import{_ as le}from"./z-paging.CcGAQywI.js";import{o as se,a as te,b as oe,c as ne,r as re}from"./uni-app.es.BFzw-cPf.js";import{p as ce,i as ie}from"./pwa.DEqUVdea.js";const ue=18e5,de=e({__name:"home",setup(e){a();const{appLogin:de,userBalance:pe,userDetail:fe,userHaveCallCard:ge}=l(s()),me=t([]),he=t([]);let ye=null,ve=null,_e=!0;se((()=>{console.log("首页出现 重启动画"),Te.value=o("devicePermission"),_e=!0,we=Date.now(),null!=ye&&ye.restart(),0==Te.value&&n()&&(w(),Ce())})),te((()=>{console.log("首页消失 关闭动画"),_e=!1,null!=ye&&ye.pause()}));const xe=t(),$e=(e,a)=>{console.log(`pageNo=${e} pageSize=${a}`),V({resetRepeat:1==e?1:0,success:e=>{var a;null==(a=xe.value)||a.completeByNoMore(e,!1),null!=ye&&(ye.pause(),ye=null),null!=ve&&(clearTimeout(ve),ve=null),ve=setTimeout((()=>{clearTimeout(ve),ve=null,ye=H({targets:".callIcon",rotate:[-5,5],scale:[.9,1],loop:!0,autoplay:!0,duration:1e3,easing:"easeInOutCirc",direction:"alternate"})}),500)},fail:()=>{var e;null==(e=xe.value)||e.completeByNoMore([],!1)},netFail:()=>{var e;null==(e=xe.value)||e.completeByNoMore([],!1)}})},ke=t(!1);ke.value=ce();const be=t(null),Te=t(o("devicePermission")),Ce=()=>{r({success:()=>{Te.value=!0},fail:()=>{Te.value=!1,I()}})},Ke=t(c.recharge.tr);let we=Date.now(),Ie=i()?u():d();i()&&p({type:2,success:e=>{if(console.log("首充"),!O)for(const l of e)l.ppp=l.ppp.filter((e=>1!=e.ppType&&2!=e.ppType));const a=e.filter((e=>e.ppp.length>0)).filter((e=>2==e.productType&&1==e.discountType));a.length>0?be.value=a[0]:be.value=null}});const Oe=s().$onAction((({name:e,args:a})=>{"pwaStatusChanged"==e?ke.value=ce():"globalTimerNTF"==e?_e&&(console.log("首充 倒计时计算"),we+=1e3,Ie>=we-ue?Ke.value=f(Ie,we-ue):(console.log("首充 重启一个30分钟倒计时"),i()?(g(m(),!0),Ie=u()):(h(!0),Ie=d()))):"loginStatusHadChangedNotification"==e?i()?(console.log("首充 已登录 计时起始时间切换"),Ie=u(),p({type:2,success:e=>{if(console.log("首充"),!O)for(const l of e)l.ppp=l.ppp.filter((e=>1!=e.ppType&&2!=e.ppType));const a=e.filter((e=>e.ppp.length>0)).filter((e=>2==e.productType&&1==e.discountType));a.length>0?be.value=a[0]:be.value=null}})):(console.log("首充 未登录 计时起始时间切换"),Ie=d(),be.value=null):"orderCompleteNotification"==e&&p({type:2,success:e=>{if(console.log("首充"),!O)for(const l of e)l.ppp=l.ppp.filter((e=>1!=e.ppType&&2!=e.ppType));const a=e.filter((e=>e.ppp.length>0)).filter((e=>2==e.productType&&1==e.discountType));a.length>0?be.value=a[0]:be.value=null}})}));oe((()=>{console.log("首页初始化 Adjust归因 上传一次"),y(),v(),_({}),x(),s().loadAllConversations({success:()=>{console.log("App初始化开始设置会话角标"),s().updateConversationBadge()}})})),ne((()=>{Oe(),null!=ye&&(ye.pause(),ye=null),null!=ve&&(clearTimeout(ve),ve=null)}));let Ne=0,De=0;return $((()=>{document.querySelector(".zp-paging-container-content").addEventListener("touchstart",(function(e){const a=e.touches[0].clientY;De=a})),document.querySelector(".zp-paging-container-content").addEventListener("touchmove",(function(e){const a=e.touches[0].clientY;Ne=Math.max(Ne,Math.abs(a-De))})),document.querySelector(".zp-paging-container-content").addEventListener("touchend",(function(e){Ne>=80&&(console.log("AII home 有效滑动触发一次"),k()),Ne=0}))})),(e,a)=>{const l=N,s=ee,t=ae,o=Q,n=G,r=re(b("z-paging"),le);return T(),C(l,{class:"bg"},{default:K((()=>[D(r,{class:"refresh-page","default-theme-style":"white",ref_key:"paging",ref:xe,modelValue:he.value,"onUpdate:modelValue":a[0]||(a[0]=e=>he.value=e),onQuery:$e,"refresher-default-text":e.$lanKey.refreshPullDown.tr,"refresher-pulling-text":e.$lanKey.refreshPullDown.tr,"refresher-refreshing-text":e.$lanKey.refreshing.tr,"refresher-complete-text":e.$lanKey.refreshPullDown.tr,"loading-more-default-text":e.$lanKey.refreshLoadMore.tr,"loading-more-loading-text":e.$lanKey.refreshLoading.tr,"loading-more-no-more-text":e.$lanKey.refreshNoMore.tr,"loading-more-fail-text":e.$lanKey.refreshLoadFail.tr},{loadingMoreNoMore:K((()=>[D(l)])),empty:K((()=>[D(l,{class:"zp-common-empty"})])),default:K((()=>[D(o,{class:"home-banner",autoplay:!1,interval:3e3,duration:1e3},{default:K((()=>[(T(!0),M(z,null,P(me.value,((e,a)=>(T(),C(t,{key:a},{default:K((()=>[D(l,{class:"swiper-item home-banner-item"},{default:K((()=>[D(s,{class:"place-holder-gradient",style:{width:"100%",height:"100%","border-radius":"40rpx"},src:"",mode:"aspectFill"})])),_:1})])),_:2},1024)))),128))])),_:1}),D(l,{class:"anchor-list"},{default:K((()=>[(T(!0),M(z,null,P(he.value,((a,s)=>(T(),C(l,{class:"anchor-item place-holder-gradient",key:s},{default:K((()=>[D(l,{onClick:e=>{return l=a.userId,void Z({url:`/pages/anchor-detail/anchor-detail?anchorUserId=${l}`});var l},class:"anchor-item-content",style:J({backgroundImage:`url(${a.cover})`})},{default:K((()=>[D(l,{class:"anchor-status"},{default:K((()=>[D(l,{class:W(["anchor-status-icon",0==a.isOnline?"anchor-status-offline":1==a.isOnline?"anchor-status-online":"anchor-status-busy"])},null,8,["class"]),D(n,{class:W(["anchor-status-tip",0==a.isOnline?"anchor-status-offline-c":1==a.isOnline?"anchor-status-online-c":"anchor-status-busy-c"])},{default:K((()=>[F(S(0==a.isOnline?e.$lanKey.offline.tr:1==a.isOnline?e.$lanKey.online.tr:e.$lanKey.busy.tr),1)])),_:2},1032,["class"])])),_:2},1024),D(l,{class:"anchor-detail"},{default:K((()=>[D(l,{style:{"flex-grow":"1",display:"flex","flex-direction":"column",width:"0"}},{default:K((()=>[D(l,{style:{display:"flex","justify-content":"flex-start","align-items":"center"}},{default:K((()=>[D(l,{class:"countryIcon",style:J({backgroundImage:`url(${null==a?void 0:a.countryPath})`})},null,8,["style"]),D(n,{class:"country-title"},{default:K((()=>[F(S(null==a?void 0:a.countryTitle),1)])),_:2},1024)])),_:2},1024),D(n,{class:"anchor-name"},{default:K((()=>[F(S(null==a?void 0:a.nickname),1)])),_:2},1024)])),_:2},1024),D(l,{onClick:e=>((e,a)=>{a.stopPropagation(),i()?1==(null==e?void 0:e.isOnline)?X({anchorId:null==e?void 0:e.userId}):Z({url:`/pages/tab_bar/conversation/msg/msg?anchorId=${null==e?void 0:e.userId}`}):Y()})(a,e),class:W(["icon",1==(null==a?void 0:a.isOnline)?"callIcon":"msgIcon"])},{default:K((()=>[1!=(null==a?void 0:a.isOnline)||A(de)&&!A(ge)?E("",!0):(T(),C(l,{key:0,class:"float-tip"},{default:K((()=>[D(l,{class:"tip"},{default:K((()=>[D(n,{class:"txt"},{default:K((()=>[F(S(e.$lanKey.free.tr),1)])),_:1})])),_:1}),D(l,{class:"down-arrow"})])),_:1}))])),_:2},1032,["onClick","class"])])),_:2},1024)])),_:2},1032,["onClick","style"])])),_:2},1024)))),128))])),_:1})])),_:1},8,["modelValue","refresher-default-text","refresher-pulling-text","refresher-refreshing-text","refresher-complete-text","loading-more-default-text","loading-more-loading-text","loading-more-no-more-text","loading-more-fail-text"]),D(l,{class:"gradient-mask-top"}),D(l,{class:"gradient-mask-bottom"}),L(D(l,{class:"permission-tip",onClick:a[1]||(a[1]=e=>Ce())},{default:K((()=>[D(n,{class:"tip"},{default:K((()=>[F(S(e.$lanKey.mediaDiveceDisable.tr),1)])),_:1}),D(l,{class:"add"},{default:K((()=>[F(S(e.$lanKey.toOpen.tr),1)])),_:1})])),_:1},512),[[j,!0!==Te.value]]),D(l,{class:"b-safe-top home-safe-area-top"},{default:K((()=>[D(l,{class:"b-status-bar"}),D(l,{class:"home-nav"},{default:K((()=>[D(l,{class:"home_logo"},{default:K((()=>[D(l,{class:"home_logo_logo"}),D(l,{class:"home_logo_logo_text"})])),_:1}),A(de)?(T(),C(l,{key:0,class:"diamond-choose",onClick:a[2]||(a[2]=e=>A(B)({path:A(q).homeRemain}))},{default:K((()=>[D(l,{class:"diamond-image"}),D(n,{class:"diamond-text"},{default:K((()=>[F(S(A(pe)),1)])),_:1}),D(l,{class:"diamond-add"})])),_:1})):E("",!0)])),_:1})])),_:1}),L(D(l,{onClick:A(ie),class:"pwa-tip"},{default:K((()=>[D(n,{class:"tip"},{default:K((()=>[F(S(e.$lanKey.pwa_tip.tr),1)])),_:1}),D(l,{class:"area"},{default:K((()=>[D(l,{class:"add"},{default:K((()=>[F(S(e.$lanKey.add.tr),1)])),_:1}),D(l,{class:"cancel",onClick:a[3]||(a[3]=e=>{return a=e,ke.value=!1,void a.stopPropagation();var a})})])),_:1})])),_:1},8,["onClick"]),[[j,ke.value]]),D(l,{class:"recharge-first-float",onClick:a[4]||(a[4]=e=>(R(),void(i()?null!=be.value?U({path:q.homeFloat}):B({path:q.homeFloat}):Y())))},{default:K((()=>[D(l,{class:"recharge-first-float-time"},{default:K((()=>[A(de)&&null==be.value?(T(),C(n,{key:1},{default:K((()=>[F(S(e.$lanKey.recharge.tr),1)])),_:1})):(T(),C(n,{key:0},{default:K((()=>[F(S(Ke.value),1)])),_:1}))])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-464828b2"]]);export{de as default};
