import{_ as a,h as e,u as t,j as l,bi as s,o as n,d as i,w as u,e as d,R as o,S as c,T as r,L as f,O as g,N as v,a4 as m,a3 as _,P as p,Q as y,bj as I,a2 as h,i as $,a7 as k,a1 as x,aS as b,Y as w,z as B}from"./index-SUU5mfSv.js";const E=a({__name:"modal-gift",props:["userId"],emits:["close","choosedGift"],setup(a,{emit:b}){const{appLogin:w,userBalance:B}=e(t()),E=a,F=l([]),G=l(null),O=l(0);s({success:a=>{const e=a.filter((a=>2!=a.giftType));G.value=e[0];const t=((a,e)=>{const t=[];for(let l=0;l<a.length;l+=e)t.push(a.slice(l,l+e));return t})(e,8);"rtl"==document.documentElement.getAttribute("dir")?(F.value=t.reverse(),O.value=t.length-1):(F.value=t,O.value=0)}});const S=b;return(a,e)=>{const t=h,l=$,s=k,b=x;return n(),i(l,{class:"loginBack"},{default:u((()=>[d(l,{class:"top"},{default:u((()=>[d(t,{class:"gift-title"},{default:u((()=>[o(c(a.$lanKey.allGift.tr),1)])),_:1}),d(l,{class:"diamond-choose",onClick:e[0]||(e[0]=a=>S("showRecharge"))},{default:u((()=>[d(l,{class:"diamond-image"}),d(t,{class:"diamond-text"},{default:u((()=>[o(c(r(B)),1)])),_:1}),d(l,{class:"diamond-add"})])),_:1})])),_:1}),d(b,{current:O.value,class:"gift-list","indicator-dots":"true","indicator-active-color":"white","indicator-color":"#FFFFFF59"},{default:u((()=>[(n(!0),f(g,null,v(F.value,((e,r)=>(n(),i(s,{class:"page-item",key:r},{default:u((()=>[(n(!0),f(g,null,v(e,((e,s)=>{var r;return n(),i(l,{onClick:a=>((a,e)=>{var t;e.detail.x,e.detail.y,null!=G.value&&(null==(t=G.value)?void 0:t.gid)==(null==a?void 0:a.gid)?I({receiverId:E.userId,quantity:1,gid:a.gid,success:e=>{S("choosedGift",a)},fail:a=>{1008==(null==a?void 0:a.code)&&S("showRecharge",null==a?void 0:a.message)}}):G.value=a})(e,a),class:m(["item",{"item-select-border":e.gid==(null==(r=G.value)?void 0:r.gid)}])},{default:u((()=>{var s;return[d(l,{class:"top-content"},{default:u((()=>{var a,s,n;return[d(l,{class:"gift-icon",style:_({backgroundImage:`url(${e.icon})`})},null,8,["style"]),p(d(t,{class:"gift-name"},{default:u((()=>[o(c(e.name),1)])),_:2},1536),[[y,e.gid!=(null==(a=G.value)?void 0:a.gid)]]),d(l,{class:"price",style:_({marginBottom:e.gid==(null==(s=G.value)?void 0:s.gid)?"0rpx":"10rpx",marginTop:e.gid==(null==(n=G.value)?void 0:n.gid)?"10rpx":"0rpx"})},{default:u((()=>[d(t,{class:"diamond"},{default:u((()=>[o(c(e.diamonds.toBin),1)])),_:2},1024),d(l,{class:"diamond-image"})])),_:2},1032,["style"])]})),_:2},1024),p(d(l,{class:"send"},{default:u((()=>[d(t,null,{default:u((()=>[o(c(a.$lanKey.send.tr),1)])),_:1})])),_:2},1536),[[y,e.gid==(null==(s=G.value)?void 0:s.gid)]])]})),_:2},1032,["onClick","class"])})),256))])),_:2},1024)))),128))])),_:1},8,["current"]),d(l,{class:"bottom-safe-inset"})])),_:1})}}},[["__scopeId","data-v-2c4faac0"]]),F=a({__name:"gift-effect",props:["userId","userNickname"],setup(a,{expose:s}){const{userDetail:m}=e(t()),p=a,y=p.userId,I=l([]);let k=0;const x=l([]);return s({throwGiftEffect:a=>{const e=Date.now(),l=Object.assign({},a);l.aniId=e,l.count=1,I.value.push(l);let s=x.value.find((a=>a.gid==l.gid));s?s.count=s.count+1:(x.value.unshift(l),s=l),b((()=>{if(s.floatAni)s.floatAni.restart();else{const a=w({targets:document.getElementById(`float_${e}`),translateX:{value:-500,duration:250,delay:1250,easing:"easeInOutSine"},complete:()=>{const a=Date.now(),l=B(),n=l,i={data:{imageUrl:s.icon,count:s.count},messageType:-52,userInfo:{uid:n,virtualId:n},read:1,timestamp:a,mid:`${l}_${y}_${a}`};t().addConversation(`${l}_${y}`,i),x.value=x.value.filter((a=>a.aniId!=e))}});s.floatAni=a}var a,l;k+=1,k>=5&&(k=0),w({targets:document.getElementById(`${e}`),translateY:{value:-50*k,duration:250,delay:0,easing:"easeInOutSine"},translateX:{value:(k%2==0?-1:1)*(a=5,l=80,a=Math.ceil(a),l=Math.floor(l),Math.floor(Math.random()*(l-a+1))+a),duration:250,delay:0,easing:"easeInOutSine"},scale:{value:[0,2],duration:250,delay:0,easing:"easeInOutSine"},complete:()=>{w({targets:document.getElementById(`${e}`),scale:{value:[2,.5],duration:1e3,delay:0,easing:"easeInElastic(1, .6)"},rotate:10,complete:()=>{I.value=I.value.filter((a=>a.aniId!=e))}})}})}))}}),(a,e)=>{const t=$,l=h;return n(),i(t,{class:"gift-shoot-area"},{default:u((()=>[d(t,{class:"gift-count-float"},{default:u((()=>[(n(!0),f(g,null,v(x.value,((e,s)=>(n(),i(t,{class:"gift-count-content",key:`float_${e.aniId}`,id:`float_${e.aniId}`},{default:u((()=>{var s;return[d(t,{class:"user-portrait",style:_({backgroundImage:`url(${null==(s=r(m))?void 0:s.portrait})`})},null,8,["style"]),d(t,{class:"txt"},{default:u((()=>[d(l,null,{default:u((()=>[o(c(a.$lanKey.sendGfit.tr),1)])),_:1}),d(l,{class:"gift-name"},{default:u((()=>[o(c(null==p?void 0:p.userNickname),1)])),_:1})])),_:1}),d(t,{class:"gift-detail"},{default:u((()=>[d(t,{class:"gift-icon",style:_({backgroundImage:`url(${e.icon})`})},null,8,["style"]),d(l,{class:"count"},{default:u((()=>[o("x "+c(e.count),1)])),_:2},1024)])),_:2},1024)]})),_:2},1032,["id"])))),128))])),_:1}),(n(!0),f(g,null,v(I.value,((a,e)=>(n(),i(t,{class:"gift",key:a.aniId,id:a.aniId},{default:u((()=>[d(t,{class:"gift-icon",style:_({backgroundImage:`url(${a.icon})`})},null,8,["style"])])),_:2},1032,["id"])))),128))])),_:1})}}},[["__scopeId","data-v-33448cf6"]]);export{F as G,E as M};
